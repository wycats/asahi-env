# READ-ONLY: Use 'exo' CLI to modify this file.
# Walkthrough

[[entries]]
type = "fix"
description = "Restore implementation-plan after phase re-init"
details = """
- Reconstructed docs/agent-context/current/implementation-plan.toml steps + nested tasks via `exo impl` after it was reset by `exo phase start`.
- Set task statuses to reflect current repo state (baseline/probes done; docs partially pending; tooling portability-gating completed; doctor-tool in progress)."""

[[entries]]
type = "fix"
description = "Doctor pass + portability-gating"
details = """
- Native journald probe now matches both _SYSTEMD_UNIT=titdb.service and UNIT=titdb.service, so systemd manager messages appear (matching `journalctl -u`).
- Human doctor output treats 'journald (native)' as multiline-worthy.
- Portability-gating: doctor records missing systemctl/journalctl/keyd as skipped (not status=127), and spotlight check/apply skip cleanly when GNOME gsettings or keyd aren't present.
- Evidence snapshots: docs/agent-context/research/doctor-20251218-223518.json and docs/agent-context/research/doctor-diff-20251218-223518.json"""

[[entries]]
type = "fix"
description = "Mark titdb-fix complete"
details = """
- Verified titdb is running and ExecStart uses a stable /dev/input/by-path/... device.
- `asahi-setup check titdb` reports desired path already configured.
- Marked Phase-1 task `titdb-fix` as completed."""

[[entries]]
type = "fix"
description = "Split runbook vs manifesto steps; add small doctor probes"
details = """
- Fixed modeling mismatch by splitting the implementation plan step into "Docs: Runbook" (completed) and "Docs: Manifesto Expansion" (pending), restoring derived phase task status accuracy.
- Added doctor probes: gsettings org.gnome.mutter edge-tiling; Wi-Fi service state via systemctl is-active NetworkManager/iwd and systemctl is-enabled iwd; and optional boltctl list.
- Updated doctor probe catalog and ran cargo test -p asahi-setup."""

[[entries]]
type = "design"
description = "Manifesto: add portability + empiricism doctrines"
details = """
Changed docs/design/manifesto.md:
- Added "Portability Doctrine: Truthful by Default" emphasizing capability boundaries and explicit skipped-with-reason behavior.
- Added "Empiricism Doctrine: Evidence + Deletion" emphasizing before/after artifacts, rollback, and deletion criteria.
- Extended the Decision Matrix with prompts for portability boundaries and evidence-first tweaks."""

[[entries]]
type = "feat"
description = "asahi-setup: add Cmd tap/hold overload"
details = """
Changed tools/asahi-setup Spotlight/keyd patching:
- Patch [main] leftmeta to use keyd overload: tap Cmd -> GNOME Overview (M), hold Cmd -> meta_mac layer.
- Extend analysis output to report Cmd-tap->Overview status.
- Keep patch conservative (only rewrites leftmeta = layer(meta_mac) form) and idempotent.
- Verified with cargo tests and exo verify."""

[[entries]]
type = "design"
description = "Edge via muvm: add experiment scaffold"
details = """
Added an evidence-friendly starting point for the Edge-via-muvm investigation:
- scripts/edge-muvm-experiment.sh: minimal, gated runner that requires a user-supplied Edge RPM and captures a timestamped log under .local/edge-muvm/.
- docs/agent-context/research/edge-muvm-experiment.md: experiment checklist + artifact expectations + deletion criteria.
- Marked the implementation-plan step "Edge via muvm + packaging" as in-progress."""

[[entries]]
type = "feat"
description = "edge-muvm-experiment: profile-location + edge-arg knobs"
details = """
- Added CLI passthrough for repeatable extra Edge args (e.g. `--edge-arg=--no-sandbox`).
- Added `--profile-location` (`shared` vs `guest-tmp`) to place the profile under `/tmp` inside the guest.
- Stuck snapshots now record `/proc/<pid>/maps` line count (`maps_lines`) to sanity-check `vm.max_map_count` pressure.
- Fixed edge-arg forwarding so values starting with `-` parse correctly (forwarded as `--edge-arg=<value>`).
- Made run dir stamps millisecond resolution to avoid collisions on fast-failing runs.
- Ran a 3x3 A/B on `data:text/html,ok` (shared vs guest-tmp vs guest-tmp+no-sandbox): 0/9 completions; `maps_lines` ~1.2k << `vm_max_map_count` 65530."""

[[entries]]
type = "design"
description = "muvm GUI control: GIMP"
details = "Installed sommelier and gimp on the host and launched muvm gimp; GUI appeared and was usable. Logged as native aarch64 control (no FEX)."

[[entries]]
type = "design"
description = "muvm+FEX control: Krita x86_64 AppImage"
details = "Direct AppImage execution inside muvm failed due to missing/restricted FUSE in the guest. Workaround: host-side extraction via unsquashfs using a validated SquashFS superblock offset, then run extracted AppRun under muvm --emu=fex. Required env: PYTHONHOME set to extracted usr to avoid Python encodings init failure. Krita GUI launched and was usable."

[[entries]]
type = "fix"
description = "muvm PR prepared (not submitted)"
details = "In third_party/muvm, created local branch guest-raise-max-map-count with a single commit raising vm.max_map_count early in the guest init. Commit not pushed and no PR opened yet."
